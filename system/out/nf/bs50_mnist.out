==================================================
Algorithm: FedAvg
Local batch size: 50
Local steps: 10
Local learing rate: 0.05
Total number of clients: 20
Clients join in each round: 0.5
Client drop rate: 0.0
Time select: False
Time threthold: 10000
Global rounds: 300
Running times: 1
Dataset: mnist
Local model: resnet
Using device: cuda
Cuda device id: 0
==================================================

============= Running time: 0th =============
Creating server and clients ...

Join ratio / total clients: 0.5 / 20
Finished creating server and clients.

-------------Round number: 0-------------

Evaluate global model
Traceback (most recent call last):
  File "main.py", line 359, in <module>
    run(args)
  File "main.py", line 218, in run
    server.train()
  File "/mnt/sda1/tubitak-code/nf/PFL-Non-IID/system/flcore/servers/serveravg.py", line 31, in train
    self.evaluate()
  File "/mnt/sda1/tubitak-code/nf/PFL-Non-IID/system/flcore/servers/serverbase.py", line 189, in evaluate
    stats = self.test_metrics()
  File "/mnt/sda1/tubitak-code/nf/PFL-Non-IID/system/flcore/servers/serverbase.py", line 166, in test_metrics
    ct, ns, auc = c.test_metrics()
  File "/mnt/sda1/tubitak-code/nf/PFL-Non-IID/system/flcore/clients/clientbase.py", line 92, in test_metrics
    output = self.model(x)
  File "/home/undergrad/anaconda3/envs/fl_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/undergrad/anaconda3/envs/fl_torch/lib/python3.8/site-packages/torchvision/models/resnet.py", line 249, in forward
    return self._forward_impl(x)
  File "/home/undergrad/anaconda3/envs/fl_torch/lib/python3.8/site-packages/torchvision/models/resnet.py", line 232, in _forward_impl
    x = self.conv1(x)
  File "/home/undergrad/anaconda3/envs/fl_torch/lib/python3.8/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/undergrad/anaconda3/envs/fl_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 399, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/undergrad/anaconda3/envs/fl_torch/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 395, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Given groups=1, weight of size [64, 3, 7, 7], expected input[50, 1, 28, 28] to have 3 channels, but got 1 channels instead
